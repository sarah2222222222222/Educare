<html lang="en">
 <head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Generate, Edit and Publish Assessment or Material - Improved Design</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Inter", sans-serif;
      background-color: #f9fafb;
    }
    /* Scrollbar for textarea */
    textarea::-webkit-scrollbar {
      width: 8px;
    }
    textarea::-webkit-scrollbar-thumb {
      background-color: #3b82f6;
      border-radius: 4px;
    }
    /* Floating larger AI companion */
    @keyframes float {
            0% {
                transform: translatey(0px);
            }
            50% {
                transform: translatey(-10px);
            }
            100% {
                transform: translatey(0px);
            }
        }
        .floating {
            animation: float 2s ease-in-out infinite;
        }

        .fade-in {
            animation: fadeIn 6s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .slide-in {
            animation: slideIn 1s ease-in-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }
  </style>
 </head>
 <body class="text-gray-900">
  <div class="flex min-h-screen">
   <!-- Left Sidebar -->
   <!-- <aside
   class="flex flex-col gap-6 bg-white border border-gray-200 rounded-2xl p-4 w-full max-w-[140px] md:max-w-[160px] text-xs md:text-sm"
 >
 <nav class="flex flex-row md:flex-col space-x-6 md:space-x-0 md:space-y-6 bg-white rounded-xl p-4 md:p-6 w-full md:w-48 shadow-[0_0_10px_#f0f2f5] min-h-[auto] md:min-h-[400px] overflow-x-auto md:overflow-visible">
    <a href="../Pages/Home screen.html" class="flex items-center space-x-2 text-[#0d8cf0] font-semibold text-sm hover:text-[#0b7cd9] transition-colors duration-200 whitespace-nowrap">
     <i class="fas fa-list-ul text-lg">
     </i>
     <span>
      Home
     </span>
    </a> 
   <a href="../Pages/dash.html" class="flex items-center space-x-3 text-xs text-black font-normal hover:text-[#0d8cf0] hover:font-semibold transition-colors duration-200 whitespace-nowrap">
     <img alt="Icon of a clipboard representing classrooms" class="w-5 h-5" height="20" src="../assets/Images/live-streaming.png" width="20"/>
     <span>
      classrooms
     </span>
    </a>
    <a href="../Pages/favorites.html" class="flex items-center space-x-3 text-xs text-black font-normal hover:text-[#0d8cf0] hover:font-semibold transition-colors duration-200 whitespace-nowrap">
     <img alt="Icon of a yellow star representing favorites" class="w-5 h-5" height="20" src="../assets/Images/star.png" width="20"/>
     <span>
      favorites
     </span>
    </a>
    <a href="../Pages/archived.html" class="flex items-center space-x-3 text-xs text-black font-normal hover:text-[#0d8cf0] hover:font-semibold transition-colors duration-200 whitespace-nowrap">
     <img alt="Icon of a school building representing archived classes" class="w-5 h-5" height="20" src="../assets/Images/archive.png" width="20"/>
     <span>
      archived classes
     </span>
    </a>
    <a href="./store.html" class="flex items-center space-x-3 text-xs text-black font-normal hover:text-[#0d8cf0] hover:font-semibold transition-colors duration-200 whitespace-nowrap">
     <img alt="Icon of an app store symbol representing store" class="w-5 h-5" height="20" src="../assets/Images/app-store.png" width="20"/>
     <span>
      store
     </span>
    </a>
    <a href="./settings.html" class="flex items-center space-x-3 text-xs text-black font-normal hover:text-[#0d8cf0] hover:font-semibold transition-colors duration-200 whitespace-nowrap">
     <img alt="Icon of a gear representing settings" class="w-5 h-5" height="20" src="../assets/Images/settings.png" width="20"/>
     <span>
      settings
     </span>
    </a> 
   </nav>
 </aside> -->
   <!-- Main content -->
   <main class="flex-1 p-8 max-w-5xl mx-auto">
    <!-- Top navigation tabs -->
    <nav
      class="inline-flex items-center bg-white border border-gray-300 rounded-xl shadow px-8 py-4 mb-10 w-full"
    >
     <a
       class="text-gray-600 text-sm font-semibold mr-12 hover:text-gray-900 transition"
       href="./stream.html"
       >Stream</a
     >
     <a
       class="text-blue-600 text-sm font-semibold mr-12 hover:text-blue-800 transition"
       href="./classwork.html"
       >Classwork</a
     >
     <a
       class="text-gray-600 text-sm font-semibold mr-12 hover:text-gray-900 transition"
       href="./people.html"
       >People</a
     >
     <a
       class="text-gray-600 text-sm font-semibold mr-12 hover:text-gray-900 transition"
       href="./Messages.html"
       >Messages</a
     >
     <a
       class="text-gray-600 text-sm font-semibold mr-12 hover:text-gray-900 transition"
       href="./calendar.html"
       >Calendar</a
     >
     <button
       aria-label="Settings"
       class="ml-auto text-blue-600 hover:text-blue-800 focus:outline-none transition"
     >
      <i class="fas fa-cog fa-lg"></i>
     </button>
    </nav>

    <!-- Gemini API generation form -->
    <section class="mb-12 bg-white rounded-2xl shadow-lg p-8">
     <h1 class="text-2xl font-semibold mb-6 text-gray-800">
      Generate Assessment or Material
     </h1>
     <form id="geminiForm" class="flex flex-col gap-6 max-w-2xl">
      <div>
       <label
         for="generationType"
         class="text-sm font-semibold text-gray-700 mb-2 block"
         >Select Type</label
       >
       <select
         id="generationType"
         name="generationType"
         class="border border-gray-300 rounded-lg px-4 py-3 text-sm w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
         required
       >
        <option value="" disabled selected>Select type</option>
        <option value="assessment">Assessment</option>
        <option value="material">Material</option>
       </select>
      </div>

      <div>
       <label
         for="topicInput"
         class="text-sm font-semibold text-gray-700 mb-2 block"
         >Topic</label
       >
       <input
         type="text"
         id="topicInput"
         name="topicInput"
         placeholder="Enter topic or subject"
         class="border border-gray-300 rounded-lg px-4 py-3 text-sm w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
         required
       />
      </div>

      <div>
       <label
         for="detailsInput"
         class="text-sm font-semibold text-gray-700 mb-2 block"
         >Additional Details (optional)</label
       >
       <textarea
         id="detailsInput"
         name="detailsInput"
         rows="4"
         placeholder="Provide any specific instructions or details"
         class="border border-gray-300 rounded-lg px-4 py-3 text-sm w-full focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y transition"
       ></textarea>
      </div>

      <button
        type="submit"
        class="bg-blue-600 text-white text-sm font-semibold rounded-lg px-6 py-3 hover:bg-blue-700 transition"
      >
       Generate
      </button>
     </form>

     <div
       id="generationResultContainer"
       class="mt-8 p-6 border border-gray-300 rounded-2xl bg-gray-50 shadow-inner hidden"
     >
      <h2 class="text-lg font-semibold mb-4 text-gray-800">
       Generated Content (Editable)
      </h2>
      <textarea
        id="generationResult"
        rows="12"
        class="w-full border border-gray-300 rounded-lg p-4 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y transition"
      ></textarea>
      <div class="flex justify-end gap-4 mt-5">
       <button
         id="cancelEditBtn"
         class="text-blue-600 text-sm font-semibold hover:underline focus:outline-none"
         type="button"
       >
        Cancel
       </button>
       <button
         id="publishBtn"
         class="bg-green-600 text-white text-sm font-semibold rounded-lg px-6 py-3 hover:bg-green-700 transition"
         type="button"
       >
        Publish to Students
       </button>
      </div>
     </div>
    </section>

    <!-- Published items list -->
    <section class="bg-white rounded-2xl shadow-lg p-8">
     <h1 class="text-2xl font-semibold mb-6 text-gray-800">Published Items</h1>
     <div
       id="publishedList"
       class="divide-y divide-gray-200 border border-gray-300 rounded-xl"
     >
      <!-- Published items will appear here -->
     </div>
    </section>
   </main>
    <!-- Floating Avatar bottom right -->
    <div class="fixed bottom-4 right-4 floating">
        <a href="#" onclick="openModal()">
         <img alt="AI icon" class="w-20 h-20 rounded-full" src="../assets/Images/WhatsApp Image 2024-11-15 at 19.39.33_b2a01f1c.jpg"/>
        </a>
       </div>
  </div>

  <script>
   // Replace actual Gemini API key
    const GEMINI_API_KEY = "YOUR_GEMINI_API_KEY_HERE";

    const geminiForm = document.getElementById("geminiForm");
    const generationResultContainer = document.getElementById(
      "generationResultContainer"
    );
    const generationResult = document.getElementById("generationResult");
    const cancelEditBtn = document.getElementById("cancelEditBtn");
    const publishBtn = document.getElementById("publishBtn");
    const publishedList = document.getElementById("publishedList");

    let currentGenerationType = null;
    let currentTopic = "";
    let currentDetails = "";
    let currentEditingId = null;

    // Load published items from localStorage
    function loadPublishedItems() {
      const items = JSON.parse(localStorage.getItem("publishedItems")) || [];
      publishedList.innerHTML = "";
      if (items.length === 0) {
        publishedList.innerHTML =
          '<p class="p-6 text-sm text-gray-500 text-center">No published items yet.</p>';
        return;
      }
      items.forEach((item) => {
        const div = document.createElement("div");
        div.className =
          "flex items-center justify-between p-5 hover:bg-gray-100 transition cursor-default";
        div.innerHTML = `
          <div class="flex items-center gap-4">
            <img
              src="${
                item.type === "assessment"
                  ? "https://storage.googleapis.com/a1aa/image/10428954-0d08-4c8b-a40b-a0f516d7cebe.jpg"
                  : "https://storage.googleapis.com/a1aa/image/87de08da-f092-4732-6d05-7603384b4870.jpg"
              }"
              alt="${
                item.type === "assessment"
                  ? "Assessment icon"
                  : "Material icon"
              }"
              width="40"
              height="40"
              class="rounded-full shadow-sm"
            />
            <div>
              <p class="text-sm font-semibold text-gray-800">${item.title}</p>
              <p class="text-xs text-gray-500 italic">${item.topic}</p>
            </div>
          </div>
          <button
            class="text-blue-600 text-sm font-semibold hover:underline focus:outline-none edit-btn"
            data-id="${item.id}"
            aria-label="Edit published item"
          >
            Edit
          </button>
        `;
        publishedList.appendChild(div);
      });
    }

    // Generate unique ID
    function generateId() {
      return "id-" + Math.random().toString(36).substr(2, 9);
    }

    // Gemini API call
    async function callGeminiAPI(prompt) {
      const response = await fetch(
        "https://api.generativeai.google/v1beta2/models/text-bison-001:generate",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${GEMINI_API_KEY}`,
          },
          body: JSON.stringify({
            prompt: { text: prompt },
            temperature: 0.7,
            maxOutputTokens: 512,
          }),
        }
      );
      if (!response.ok) {
        throw new Error(`API error: ${response.statusText}`);
      }
      const data = await response.json();
      return data?.candidates?.[0]?.output || "No content generated.";
    }

    // Handle form submit to generate content
    geminiForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      currentGenerationType = geminiForm.generationType.value;
      currentTopic = geminiForm.topicInput.value.trim();
      currentDetails = geminiForm.detailsInput.value.trim();

      if (!currentGenerationType || !currentTopic) {
        alert("Please select type and enter a topic.");
        return;
      }

      generationResultContainer.classList.remove("hidden");
      generationResult.value = "Generating content, please wait...";

      try {
        let prompt = "";
        if (currentGenerationType === "assessment") {
          prompt = `Generate a detailed assessment on the topic: "${currentTopic}". Include questions and instructions. ${currentDetails}`;
        } else {
          prompt = `Generate educational material content on the topic: "${currentTopic}". Include explanations and examples. ${currentDetails}`;
        }

        const generatedText = await callGeminiAPI(prompt);
        generationResult.value = generatedText;
        currentEditingId = null;
      } catch (error) {
        generationResult.value = `Error generating content: ${error.message}`;
      }
    });

    // Cancel editing generated content
    cancelEditBtn.addEventListener("click", () => {
      generationResultContainer.classList.add("hidden");
      generationResult.value = "";
      geminiForm.reset();
      currentEditingId = null;
    });

    // Publish generated content to students
    publishBtn.addEventListener("click", () => {
      const content = generationResult.value.trim();
      if (!content) {
        alert("Generated content is empty.");
        return;
      }

      const publishedItems =
        JSON.parse(localStorage.getItem("publishedItems")) || [];

      if (currentEditingId) {
        // Update existing item
        const index = publishedItems.findIndex((i) => i.id === currentEditingId);
        if (index !== -1) {
          publishedItems[index].content = content;
          publishedItems[index].title = currentTopic + " (" + currentGenerationType + ")";
          publishedItems[index].topic = currentTopic;
          publishedItems[index].type = currentGenerationType;
        }
        currentEditingId = null;
      } else {
        // New item
        publishedItems.push({
          id: generateId(),
          type: currentGenerationType,
          topic: currentTopic,
          title: currentTopic + " (" + currentGenerationType + ")",
          content,
        });
      }

      localStorage.setItem("publishedItems", JSON.stringify(publishedItems));
      alert("Content published successfully to students.");
      generationResultContainer.classList.add("hidden");
      generationResult.value = "";
      geminiForm.reset();
      loadPublishedItems();
    });

    // Edit published item
    publishedList.addEventListener("click", (e) => {
      if (!e.target.classList.contains("edit-btn")) return;
      const id = e.target.getAttribute("data-id");
      const publishedItems =
        JSON.parse(localStorage.getItem("publishedItems")) || [];
      const item = publishedItems.find((i) => i.id === id);
      if (!item) return;

      currentEditingId = id;
      currentGenerationType = item.type;
      currentTopic = item.topic;

      geminiForm.generationType.value = item.type;
      geminiForm.topicInput.value = item.topic;
      generationResultContainer.classList.remove("hidden");
      generationResult.value = item.content;
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Initial load
    window.addEventListener("DOMContentLoaded", () => {
      loadPublishedItems();
    });
  </script>
 </body>
</html>